[comment encoding = UTF-8 /]
[module screen('http://www.eclipse.org/uml2/4.0.0/UML')]

[import xismobile::pim::uml2::gen::html5::common::utils /]
[import xismobile::pim::uml2::gen::html5::common::jsUtils /]
[import xismobile::pim::uml2::gen::html5::common::xisWebUtils /]
[import xismobile::pim::uml2::gen::html5::files::widgets /]
[import xismobile::pim::uml2::gen::html5::services::services /]

[template public generateScreen(c : Class)]

[file ('src/'.concat(c.name.toLower()).concat('.html'), false, 'UTF-8')]
[let widgets : Sequence(Class) = c.getXisInteractionSpaceWidgets()]

<!DOCTYPE HTML>
<html>
	<head>
		<title>[c.name.toUpperFirst()/]</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.css" />
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
		<script src="http://maps.googleapis.com/maps/api/js"></script>	
		<script src="js/[c.name.toLower().concat('.js')/]">
			[comment Here go the Page Specific JS functions /]
		</script>
		<script src="js/jsUtils.js">
		</script>
		<script>
		$(document).ready(function(){
			if(typeof(openDatabase) !== 'undefined')
			{
				[createDatabase(c.getModel())/]
				[if(c.isMasterEntityListIS())]
				[for(cl : Class | c.getMasterEntities())]
				[initTable(cl)/]
				[c.getModel().name.toLower()/].getAllItemsFrom[cl.name.toUpperFirst()/](loadList[cl.name.toUpperFirst()/]sIn[c.name.toUpperFirst()/]);
				[c.getModel().name.toLower()/].getAllItemsFrom[cl.name.toUpperFirst()/](hideDeleteAllButtonFor[c.name.toUpperFirst()/]);
				[/for]
				[/if]
				[if(c.isMasterEntityEditorIS())]
				[for(cl : Class | c.getMasterEntities())]
				[initTable(cl)/]
				fillContentFor[cl.name.toUpperFirst()/]In[c.name.toUpperFirst()/]();
				[/for]
				[for(cl : Class | c.getDetailEntities())]
				[initTable(cl)/]
				[c.getModel().name.toLower()/].getAllItemsFrom[cl.name.toUpperFirst()/](loadList[cl.name.toUpperFirst()/]sIn[c.name.toUpperFirst()/]);
				[/for]
				[for(cl : Class | c.getReferenceEntities())]
				[initTable(cl)/]
				[c.getModel().name.toLower()/].getAllItemsFrom[cl.name.toUpperFirst()/](loadList[cl.name.toUpperFirst()/]sIn[c.name.toUpperFirst()/]);
				[/for]
				[/if]
				[if(c.isDetailEntityEditorIS())]
				[for(cl : Class | c.getDetailEntities())]
				[initTable(cl)/]
				fillContentFor[cl.name.toUpperFirst()/]In[c.name.toUpperFirst()/]();
				[/for]
				[/if]
				[if(c.isReferenceEntityEditorIS())]
				[for(cl : Class | c.getReferenceEntities())]
				[initTable(cl)/]
				fillContentFor[cl.name.toUpperFirst()/]In[c.name.toUpperFirst()/]();
				[/for]
				[/if]
			}
		});
		</script>
	</head>
	<body>
		<div id="page-wrapper" class="container">
			<!-- Header -->
			<div id="header-wrapper">
				<div id="header">
					[for (w : Class | widgets) separator('\n')]
						[if((widgets->size() > 0) and (w.isXisSitemap() or w.isXisImage()))]
							[writeWidget(w) /]
						[/if]
					[/for]
				</div>
			</div>
		</div>
		<div class="container" id="messages_div"></div>
		<div class="container">
			[for (w : Class | widgets) separator('\n')]
				[if((widgets->size() > 0) and not((w.isXisSitemap() or w.isXisImage())))]
					[writeWidget(w) /]
				[/if]
			[/for]
		</div>
		<footer class="footer navbar-fixed-bottom">
			<div class="container">
				<p class="text-muted">Page automatically generated by XIS-Web</p>
			</div>
		</footer>
	</body>
</html>

[/let]
[/file]

[/template]
