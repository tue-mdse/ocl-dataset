[comment encoding = UTF-8 /]
[module genTests('http://www.eclipse.org/intent/specification/1.0')]
[import fr::obeo::intent::spec2test::files::ui::genTestSuite /]
[import fr::obeo::intent::spec2test::files::ui::genContext /]
[import fr::obeo::intent::spec2test::files::ui::genContextMenuHelper /]
[import fr::obeo::intent::spec2test::files::ui::genAbstractContext /]
[import fr::obeo::intent::spec2test::files::ui::genIContext /]
[import fr::obeo::intent::spec2test::files::ui::genContextStatement /]
[import fr::obeo::intent::spec2test::files::genAutomationUtils/]

[template public genTests(specification : Specification)]
[comment @main/]
[genTestSuites(specification, TestType::ui)/]
[genTestSuites(specification, TestType::unit)/]
[genTestSuites(specification, TestType::plugin)/]
[genManualTestSuites(specification)/]

[comment Contexts/]
[for (contxt : Context | specification.automationLayer._context->asSet())]
	[genContext(contxt)/]
[/for]

[genContextMenuHelper()/]
[genAbstractContext()/]
[genIContext()/]
[genContextStatement()/]
[/template]

[template public genTestSuites (specification : Specification, type : TestType) ]
[genTestSuite(specification, type)/]
[for (feature : NamedElement | specification.getTestTypeFeatures(type))]
	[genTestSuite(feature, type)/]
[/for]
[/template]

[template public genManualTestSuites(specification : Specification)]
	[file (specification.getCamelCaseName()+'ManualTestSuite.txt', false, 'UTF-8')]
[comment]Get manual scenarios[/comment]
[for (feature : Feature | specification.getTestTypeFeatures(TestType::manual))]
Feature : [feature.name/]
[for (story : Story | feature.getTestTypeStories(TestType::manual))]
	Story : [story.name/]
		[for (scenario : Scenario | story.getTestTypeScenarios(TestType::manual))]
		Scenario : [scenario.name/]
			[for (given : Context | scenario.given)]
			Given [given.name/]
			[/for]
			[for (when : Action | scenario.when)]
			When [when.name/]
			[/for]
			[for (_then : Behaviour | scenario._then)]
			Then [_then.name/]
			[/for]
		[/for]
	[/for]
[/for]
[/file]
[/template]