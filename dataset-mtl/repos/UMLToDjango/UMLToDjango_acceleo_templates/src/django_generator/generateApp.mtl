[comment encoding = UTF-8 /]
[module generateApp('http://www.eclipse.org/uml2/5.0.0/UML')]
[import django_generator::initAppPackage/]
[import django_generator::generateAdmin/]
[import django_generator::generateUrls/]
[import django_generator::generateModel/]
[import django_generator::generateModelRestSerializer/]
[import django_generator::generateModelRestSerializerFunctionalTest/]
[import django_generator::generateModelRestSerializerBehaviouralTest/]
[import django_generator::generateFileHeaderComment/]

[template public generateApp(p : Package)]
[p.initAppPackage()/]
[p.generateAdmin()/]
[p.generateUrls()/]

[file(p.name+'/models.py', false)]
[generateFileHeaderComment(p)/]
[for (c:Class | p.packagedElement->filter(Class))]
[if(c.getAppliedStereotype('UMLToDjango_profile::DjangoModel')<>null)]
from [p.name/].model.[c.name.toLowerCase()/] import [c.name/]
[/if]
[/for]
[/file]

[for (c:Class | p.packagedElement->filter(Class))]
[if(c.getAppliedStereotype('UMLToDjango_profile::DjangoModel')<>null)]
[file(p.name+'/model/'+c.name.toLowerCase()+'.py', false)]
[generateFileHeaderComment(p)/]
[c.generateModel()/]
[/file]
[/if]
[/for]

[for (c:Class | p.packagedElement->filter(Class))]
[if(c.getAppliedStereotype('UMLToDjango_profile::DjangoModel')<>null)]
[c.generateModelRestSerializer(p)/]
[c.generateModelRestSerializerFunctionalTest(p)/]
[c.generateModelRestSerializerBehaviouralTest(p)/]
[/if]
[/for]

[/template]
